# 前言
此次课题，基于linux for centos7进行安装部署。
此次基于zip安装包，如果是rpm包安装（可以参考Oracle19c的部署）
之前一直在Windows上进行安装部署测试的，其实在linux操作系统上部署基本上可以参考Windows的图形界面安装。
图形化安装和Windows配置是差不多的，我安装的时候就是参考以前Windows上部署的经验。
部分安装注意事项还是需要注意，比如不能用root用户直接安装，需要新建普通用户安装。


# 正文

## 一、注意事项

以root用户执行命令
```powershell
#以root用户执行命令
xhost +
```

加入你的ip配置
```powershell
#以root用户执行命令
export $DISPLAY=IP:0.0
```

新增oracle用户
```powershell
#新增oracle用户
adduser oracle
```

修改密码
```powershell
#修改密码
passwd oracle
```

切换用户
```powershell
#切换用户oracle
su oracle
```

安装软件
```powershell
#执行命令
sh runInstaller 
#或者执行 
./runInstaller
```

乱码问题临时解决（安装显示英文模式）
LANG=en_US sh runInstaller 或者./runInstaller


## 二、完全安装
直接配置(create and configure a database：选择创建并配置数据库)


## 三、分步骤安装（install database software only：仅安装数据库软件 ）

首先进入到安装软件后的oracle的bin目录

安装监听
```powershell
./netca
#临时解决乱码问题，以英文模式安装
LANG=en_US.UTF-8 ./netca 
```

安装数据库实例
```powershell
./dbca
#解决乱码问题，以英文模式安装
LANG=en_US.UTF-8 ./dbca
```

## 四、优化配置

部署目录
```powershell
#部署目录，此处部署目录根据实际情况调整
/home/oracle/app/product/11.2.0/dbhome_1/bin/
#进入bin目录
cd /home/oracle/app/product/11.2.0/dbhome_1/bin/
#直接查看bin目录下的文件
ls /home/oracle/app/product/11.2.0/dbhome_1/bin/
```

#set hostname
```powershell
#set hostname
vim /etc/hostname
```

#set listener tns
```powershell
#set listener tnsnames
vim /home/oracle/app/product/11.2.0/dbhome_1/network/admin/listener.ora 
vim /home/oracle/app/product/11.2.0/dbhome_1/network/admin/tnsnames.ora
```

listener.ora 配置文件新增内容
```powershell
# listener.ora Network Configuration File: /home/oracle/app/product/11.2.0/dbhome_1/network/admin/listener.ora
# Generated by Oracle configuration tools.
#listener.ora 配置文件新增内容
SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = orcl)
      (ORACLE_HOME = /home/oracle/app/product/11.2.0/dbhome_1/)
      #(PROGRAM = extproc) //去掉PROGRAM = extproc，外部通道调用动态dll
      (ENVS = "EXTPROC_DLLS=ONLY:/home/oracle/app/product/11.2.0/dbhome_1/bin/oraclr11.dll")
    )
  )

#原始配置
LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.245.147)(PORT = 1521))
    )
  )

ADR_BASE_LISTENER = /home/oracle/app

```


tnsnames.ora新增内容
```powershell
# tnsnames.ora Network Configuration File: /home/oracle/app/product/11.2.0/dbhome_1/network/admin/tnsnames.ora
# Generated by Oracle configuration tools.
#tnsnames.ora新增内容
ORACLR_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
    (CONNECT_DATA =
      (SID = CLRExtProc)
      (PRESENTATION = RO)
    )
  )

ORCL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.245.147)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orcl)
    )
  )

```

oracle home，设置oracle环境变量
```powershell
ORACLE_BASE=/home/oracle/app;
ORACLE_HOME=$ORACLE_BASE/product/11.2.0/dbhome_1;
PATH=$ORACLE_HOME/bin:$PATH;
ORACLE_SID=orcl;

export ORACLE_SID ORACLE_BASE ORACLE_HOME PATH
```

set user oralce 当前用户生效
```powershell
sudo oracle
```

进入当前用户的home（家目录）
```powershell
cd ~
```

新增环境变量
```powershell
vim .bash_profile 
```

加入配置
```powershell
ORACLE_BASE=/home/oracle/app;
ORACLE_HOME=$ORACLE_BASE/product/11.2.0/dbhome_1;
PATH=$ORACLE_HOME/bin:$PATH;
ORACLE_SID=orcl;

export ORACLE_SID ORACLE_BASE ORACLE_HOME PATH
```

```powershell
cd /home/oracle/app/product/11.2.0/dbhome_1/bin/
```

启动监听
```powershell
./lsnrctl start
```


set all user 设置所用户生效
```powershell
vim /etc/profile
```
```powershell
ORACLE_BASE=/home/oracle/app;
ORACLE_HOME=$ORACLE_BASE/product/11.2.0/dbhome_1;
PATH=$ORACLE_HOME/bin:$PATH;
ORACLE_SID=orcl;

export ORACLE_SID ORACLE_BASE ORACLE_HOME PATH
```

启动
```powershell
lsnrctl start
```

登录
```powershell
sqlplus /nolog
```
连接sqlplus
```powershell
conn system as sysdba
```

启动与关闭实例
```powershell
#启动实例
startup
#关闭实例
shutdown
```powershell


## 五、解决问题
1、Oracle home环境变量
cd ~
cat .bash_profile

2、listener.ora、tnsnames监听文件
检查：cat /home/oracle/app/product/11.2.0/dbhome_1/network/admin/listener.ora 
检查：cat /home/oracle/app/product/11.2.0/dbhome_1/network/admin/tnsnames.ora

3、主机名一致性
检查：cat /etc/hosts
检查：cat /home/oracle/app/product/11.2.0/dbhome_1/network/admin/listener.ora 
检查：cat /home/oracle/app/product/11.2.0/dbhome_1/network/admin/tnsnames.ora


4、安装时显示乱码问题
在命令前加上：LANAG=en_US

5、关于服务开机自启问题
使用官方提供的脚本
执行root.sh脚本
/home/oracle/app/product/11.2.0/dbhome_1/root.sh

生成oratab文件
/etc/oratab

```powershell
#代表开启自动
$ORACLE_SID:$ORACLE_HOME:Y
通过dbstart、dbshut控制启动与停止服务
```


## Oracle19c部分

tips：下载需要注册Oracle账号并且登录，真的很骚。

官网地址
https://www.oracle.com/cn/database/technologies/oracle-database-software-downloads.html#19c

下载地址
https://www.oracle.com/webapps/redirect/signon?nexturl=https://download.oracle.com/otn/linux/oracle19c/190000/oracle-database-ee-19c-1.0-1.x86_64.rpm

前提条件（rpm安装会提示依赖包）
```powershell
yum -y install libaio-devel
yum -y install ksh
```

安装
```powershell
rpm -ivh oracle-database-preinstall-19c-1.0-3.el7.x86_64.rpm
rpm -ivh oracle-database-ee-19c-1.0-1.x86_64.rpm
```

或者
```powershell
yum -y install oracle-database-preinstall-19c-1.0-3.el7.x86_64.rpm
yum -y install oracle-database-ee-19c-1.0-1.x86_64.rpm
```

执行部署配置
```powershell
/etc/init.d/oracledb_ORCLCDB-19c configure
```


默认的安装位置：set oracle home SID：ORCLCDB
```sql
/opt/oracle/product/19c/dbhome_1/
```

加入环境变量
vim .bash_profile

```powershell
ORACLE_BASE=/opt/oracle;
ORACLE_HOME=$ORACLE_BASE/product/19c/dbhome_1;
PATH=$ORACLE_HOME/bin:$PATH;
ORACLE_SID=ORCLCDB;

export ORACLE_SID ORACLE_BASE ORACLE_HOME PATH
```

执行后生效
```powershell
source .bash_profile
```

登录sqlplus
```sql
/opt/oracle/product/19c/dbhome_1/bin/sqlplus / as sysdba
```

显示用户
```sql
show user;
```

启动实例
```sql
startup;
```

修改system密码
```sql
alter user system identified by 123456;
```

设置字符集，统一编码

设置中文（我部署的centos7选择的中文）
```sql
export NLS_LANG="Simplified Chinese_china.al32utf8"
```

Oracle默认的编码
```sql
--Oracle默认的编码
export NLS_LANG="SIMPLIFIED CHINESE_CHINA.ZHS16GBK"
```


创建用户需要加c##的问题

```sql
--报错
create user test;
```

```sql
--解决问题
reate user c##test;
```

与容器数据库新特性有关

解决方案
```sql
--我修改了并没生效
ALTER PLUGGABLE DATABASE PDB$SEED CLOSE ;
```


# 开心一刻

> 只要你找个好老板，找一份好工作，好好工作。
> 辛勤工作，早起晚归，经常加班。
> 早晚有一天，这个老板，会更有钱。
> 换更好的车，换更好的房。
> 再给我一个机会，我想回到昨天，因为我安眠药吃多了。

上面的引用就当玩笑话，乐呵乐呵。创作乐无边，学而思有境。你会发现，了解的越多，不了解的越多。好了，到此为止就是此篇文章的全部内容了，**能看到这里的都是帅哥靓妹啊**！！！善于总结，其乐不穷。**好记性不如烂笔头**，多收集自己第一次尝试的成果，收获也颇丰。**你会发现，自己的知识宝库越来越丰富**。白嫖有瘾，原创不易，快乐阅读！


<H3 align=center><a href="https://blog.csdn.net/Tolove_dream">by 龙腾万里sky 原创不易，白嫖有瘾</a></H3>